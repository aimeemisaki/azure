# ラボの解答

これには二つの重要な部分があります：

- 消費者は任意のパーティションから読み取るのではなく、特定のパーティション内のイベントを読み取ることができます。
- 消費者は最初から始めるのではなく、パーティション内のオフセットからイベントを読み取ることができます。

複数の消費者を持ち、それぞれが異なるパーティションから読み取ることにより、スケールで実行できます。彼らは並行してイベントを処理します。

消費者は各イベントを処理すると、オフセットを記録できます。これはサービスバスのメッセージとは異なり、消費者がメッセージが処理されたことをサービスバスにフラグを立てるのではありません。代わりに消費者は、ストリーム内でどこまで進んだかの自身の記録を保持します。

オフセットはイベントハブによって各パーティションごとに計算され、消費者が受け取るイベントメタデータに含まれます。消費者が起動すると、1つのパーティションを使用するように設定され、最後に処理したオフセットの自身の記録を調べます。そして、指定されたオフセットからそのパーティション内のイベントの受信を開始するようイベントハブに接続し、前回終了したところから開始します。
